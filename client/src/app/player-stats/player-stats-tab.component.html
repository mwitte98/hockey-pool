<div class="table-wrapper">
  <table
    mat-table
    matSort
    matSortActive="points"
    matSortDirection="desc"
    matSortStart="desc"
    class="table"
    [dataSource]="dataSource"
    (matSortChange)="sortChange($event)">
    <ng-container matColumnDef="name" sticky>
      <th *matHeaderCellDef mat-header-cell mat-sort-header class="name-col" start="asc">Name</th>
      <td *matCellDef="let player" mat-cell class="name-col sticky">
        <span [ngClass]="player.team.isEliminated ? 'strikethrough' : ''">
          <span>{{ player.firstName }} {{ player.lastName }} ({{ player.team.abbr }}</span>
          <span *ngIf="player.position !== 'Goalie'">-{{ player.position | slice : 0 : 1 }}</span>
          <span>)</span>
        </span>
      </td>
    </ng-container>
    <ng-container *ngFor="let col of playerStatColumns; trackBy: trackBy" [matColumnDef]="col.stat">
      <th *matHeaderCellDef mat-header-cell mat-sort-header>
        <span>
          {{ col.header }}
          <ng-container *ngIf="isFinals">(x2)</ng-container>
        </span>
      </th>
      <td *matCellDef="let player" mat-cell>
        {{ player[col.stat] ?? 0 }}
        <ng-container *ngIf="player.team.inFinals">({{ getFinalsStat(col, player) ?? 0 }})</ng-container>
      </td>
    </ng-container>
    <ng-container matColumnDef="points" stickyEnd>
      <th *matHeaderCellDef mat-header-cell mat-sort-header>Points</th>
      <td *matCellDef="let player" mat-cell class="sticky">{{ player.points ?? 0 }}</td>
    </ng-container>

    <tr *matHeaderRowDef="columnsToDisplay; sticky: true" mat-header-row></tr>
    <tr *matRowDef="let player; columns: columnsToDisplay" mat-row></tr>
  </table>
</div>
